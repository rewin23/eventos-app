<ion-card class="calendar-container">
  <!-- Header del calendario -->
  <ion-card-header>
    <div class="calendar-header">
      <ion-button fill="clear" size="small" (click)="previousMonth()">
        <ion-icon name="chevron-back" slot="icon-only"></ion-icon>
      </ion-button>
      
      <ion-card-title class="month-year">
        {{ getCurrentMonthYear() }}
      </ion-card-title>
      
      <ion-button fill="clear" size="small" (click)="nextMonth()">
        <ion-icon name="chevron-forward" slot="icon-only"></ion-icon>
      </ion-button>
    </div>
  </ion-card-header>

  <!-- Contenido del calendario -->
  <ion-card-content>
    <!-- Días de la semana -->
    <div class="weekdays-row">
      <div class="weekday" *ngFor="let day of weekDays">
        {{ day }}
      </div>
    </div>

    <!-- Grid del calendario -->
    <div class="calendar-grid">
      <div 
        class="calendar-day"
        *ngFor="let day of calendarDays"
        [class.other-month]="!day.isCurrentMonth"
        [class.today]="day.isToday"
        [class.selected]="selectedDate && selectedDate.toDateString() === day.date.toDateString()"
        [class.has-events]="day.hasEvents"
        (click)="onDayClick(day)">
        
        <div class="day-number">{{ day.day }}</div>
        
        <!-- Indicador de eventos -->
        <div class="events-indicators" *ngIf="day.hasEvents">
          <div 
            class="event-dot"
            *ngFor="let event of day.events.slice(0, 3)"
            [style.background-color]="getEventColor(event)"
            (click)="onEventClick(event, $event)">
          </div>
          <div class="more-events" *ngIf="day.events.length > 3">
            +{{ day.events.length - 3 }}
          </div>
        </div>

        <!-- Botón para crear evento -->
        <ion-button 
          *ngIf="allowEventCreation && day.isCurrentMonth"
          fill="clear" 
          size="small" 
          class="create-event-btn"
          (click)="onCreateEventClick(day.date, $event)">
          <ion-icon name="add" slot="icon-only"></ion-icon>
        </ion-button>
      </div>
    </div>
  </ion-card-content>
</ion-card>

<!-- Lista de eventos del día seleccionado -->
<ion-card *ngIf="showEventList && selectedDate" class="events-list">
  <ion-card-header>
    <ion-card-title>
      Eventos del {{ selectedDate | date:'dd/MM/yyyy' }}
    </ion-card-title>
  </ion-card-header>
  
  <ion-card-content>
    <div *ngIf="getSelectedDateEvents().length === 0" class="no-events">
      <p>No hay eventos programados para esta fecha</p>
      <ion-button 
        *ngIf="allowEventCreation"
        fill="outline" 
        size="small"
        (click)="onCreateEventClick(selectedDate, $event)">
        <ion-icon name="add" slot="start"></ion-icon>
        Crear evento
      </ion-button>
    </div>
    
    <ion-list *ngIf="getSelectedDateEvents().length > 0">
      <ion-item 
        *ngFor="let event of getSelectedDateEvents()"
        button
        (click)="onEventClick(event, $event)">
        
        <div class="event-indicator" [style.background-color]="getEventColor(event)"></div>
        
        <ion-label>
          <h3>{{ event.title }}</h3>
          <p *ngIf="event.startAt">
            {{ formatTime(event.startAt) }}
            <span *ngIf="event.endAt"> - {{ formatTime(event.endAt) }}</span>
          </p>
          <p *ngIf="event.description" class="event-description">
            {{ event.description }}
          </p>
          <ion-badge *ngIf="event.category" color="medium">
            {{ event.category }}
          </ion-badge>
        </ion-label>
        
        <ion-icon name="chevron-forward" slot="end"></ion-icon>
      </ion-item>
    </ion-list>
  </ion-card-content>
</ion-card>